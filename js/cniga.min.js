function snap(e,t){for(var n=e.length-1;n>=0&&(e[n]!==t||(e.splice(n,1),!0!==multi));n--);}function trackEvent(e,t,n,o){o?(_paq.push(["trackEvent",e,t,n,o]),console.log("CATEGORY: "+e+", ACTION:"+t+", LABEL:"+n+", VALUE:"+o)):n?(_paq.push(["trackEvent",e,t,n]),console.log("CATEGORY: "+e+", ACTION:"+t+", LABEL:"+n)):(_paq.push(["trackEvent",e,t]),console.log("CATEGORY: "+e+", ACTION:"+t))}var _paq=_paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),window.onload=function(){var e="https://circle.red/stats/";_paq.push(["setTrackerUrl",e+"piwik.php"]),_paq.push(["setSiteId","2"]);var t=document,n=t.createElement("script"),o=t.getElementsByTagName("script")[0];n.type="text/javascript",n.async=!0,n.defer=!0,n.src=e+"piwik.js",o.parentNode.insertBefore(n,o)};var windowHeight=window.innerHeight,app=new Vue({el:"#app",data:{my:{userType:"member",view:"news",contactChoice:!1,readItems:[],unreadItems:0,sentBills:[],expandedBills:[],email:"",loginCode:""},loginStatus:"guest",news:[],billsLoading:!0,stateSupport:{},stateSupportShow:!1,stateOppose:{},stateOpposeShow:!1,stateMonitor:{},stateMonitorShow:!1,schedule:{},scheduleShow:!1},computed:{myNews:function(){var e=this;return e.news.map(function(t){return-1!==e.my.readItems.indexOf(t.slug)&&(t.read=!0),t})}},methods:{checkPassword:function(){var e=this;e.my.email.includes("redcircle")?e.loginStatus="validating":e.loginStatus="error"},checkLoginCode:function(){var e=this;e.my.loginCode.toUpperCase().includes("X")?(e.loginStatus="member",e.my.userType="member",e.my.view="news"):e.loginStatus="validateError"},newAlert:function(e){alert(e)},beforeEnter:function(e){e.style.opacity=0},slideDown:function(e,t){Velocity(e,"slideDown",{duration:500})},slideUp:function(e,t){Velocity(e,"slideUp",{duration:300})},openLink:function(e,t){"undefined"!=typeof cordova&&(window.open=cordova.InAppBrowser.open),window.open(e,t)},emailLink:function(e,t){return"mailto:?subject="+e+"&body="+t},markNewsRead:function(e){var t=this;-1===t.my.readItems.indexOf(e)&&t.my.readItems.push(e),t.countUnreadNews()},countUnreadNews:function(){var e=this;e.my.unreadItems=0,e.news.map(function(t){-1===e.my.readItems.indexOf(t.slug)&&e.my.unreadItems++})},bindEvents:function(){console.log("Bind Events"),document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){this.deviceready=!0,console.log("Received Device Ready Event"),console.log("calling setup push"),app.setupPush()},setupPush:function(){console.log("calling push init");var e=PushNotification.init({android:{senderID:"1098348384269"},browser:{},ios:{sound:!0,vibration:!0,badge:!0},windows:{}});console.log("after init"),e.on("registration",function(e){console.log("registration event: "+e.registrationId),localStorage.getItem("registrationId")!==e.registrationId&&localStorage.setItem("registrationId",e.registrationId)}),e.on("error",function(e){console.log("push error = "+e.message)}),e.on("notification",function(e){console.log("notification event"),navigator.notification.alert(e.message,null,e.title,"Ok")})},getContent:function(){var e=this;fetch("https://circle.red/cniga/").then(function(e){return e.json()}).then(function(t){e.schedule=t.schedule,e.news=t.news,e.countUnreadNews()}).catch(function(t){console.log(t),e.countUnreadNews()})},getBills:function(){var e=this;fetch("https://circle.red/cniga/legislation").then(function(e){return e.json()}).then(function(t){e.stateSupport=t.billssupporting,e.stateOppose=t.billsopposing,e.stateMonitor=t.billsmonitoring,e.billsLoading=!1}).catch(function(e){console.log(e)})},toggleEmailSent:function(e){var t=this;-1===t.my.sentBills.indexOf(e)?t.my.sentBills.push(e):t.my.sentBills.splice(t.my.sentBills.indexOf(e),1),trackEvent("Member marked email sent",e)},toggleBillCollapse:function(e){var t=this;if(t.my.expandedBills.includes(e)){var n=t.my.expandedBills.indexOf(e);-1!=n&&t.my.expandedBills.splice(n,1)}else t.my.expandedBills.push(e)},getMyData:function(){var e=this;e.getObjectStore("my","readonly").openCursor().onsuccess=function(t){var n=t.target.result;n&&(e.my=n.value,e.error_msg?e.my.view="error":e.my.view="news")}},updateMyData:function(){var e=this,t=e.getObjectStore("my","readwrite");t.count().onsuccess=function(n){if(0===n.target.result)try{t.add(e.my,0)}catch(e){throw e}else t.openCursor().onsuccess=function(t){var n=t.target.result;if(n)try{n.update(e.my)}catch(e){throw e}}}},getObjectStore:function(e,t){return this.db.transaction(e,t).objectStore(e)},trackEvent:function(e,t,n,o){o?(_paq.push(["trackEvent",e,t,n,o]),console.log("CATEGORY: "+e+", ACTION:"+t+", LABEL:"+n+", VALUE:"+o)):n?(_paq.push(["trackEvent",e,t,n]),console.log("CATEGORY: "+e+", ACTION:"+t+", LABEL:"+n)):(_paq.push(["trackEvent",e,t]),console.log("CATEGORY: "+e+", ACTION:"+t))}},mounted:function(){var e=this;e.countUnreadNews(),e.bindEvents(),e.getContent(),e.getBills();var t=indexedDB.open("CNIGAApp",3);t.onerror=function(t){e.indexed="Can't use IndexedDB"},t.onsuccess=function(t){e.db=this.result,e.getMyData(),e.my.view="news"},t.onupgradeneeded=function(e){e.currentTarget.result.createObjectStore("my")}},updated:function(){var e=this,t=indexedDB.open("CNIGAApp",3);t.onerror=function(t){e.indexed="Can't use IndexedDB"},t.onsuccess=function(t){e.db=this.result,e.updateMyData()},t.onupgradeneeded=function(e){e.currentTarget.result.createObjectStore("my")}}});
//# sourceMappingURL=cniga.min.js.map